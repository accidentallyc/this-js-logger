!function(){function e(e){for(var o in e){var r=c.getAttribute(o);if(r)switch(typeof e[o]){case"number":e[o]=parseInt(r);break;case"boolean":e[o]="true"==r;break;default:e[o]=r}}return e}function o(){return a?a:(a=openDatabase(u["logger-db"],"1.0",u["logger-db-descp"],512),a.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS "+u["logger-db"]+" (log TEXT)")}),a)}function r(e,o,r){var n=E[o],l=e.settings["logger-record-flag"],i=s[e.settings["logger-level"].toUpperCase()]<s[o],a=null===w.ns_list?!1:-1==w.ns_list.indexOf(r);return i||a?R:function(e,i){void 0==l&&(l=!0);var a=(new Date).toLocaleString(),g=(new Error).stack.substring(6),c=r?"< "+r+" >\n":"",s=r?"\n</ "+r+" >":"";if(i){var d="%c"+o+" %c"+e+" -- "+a;console.log(d,n.header,n.body,i),console.log("%c"+g,n.body)}else{var u=c+"%c"+o+" %c"+e+" -- "+a+"\n"+g+s;console.log(u,n.header,n.body)}l&&t(o,e,g,a,i)}}function t(e,r,t,n,l){var i=o();i.transaction(function(o){var i=e+" : "+r+" -- "+n;l&&(i+=" "+JSON.stringify(l)),i+="\r\n"+t,o.executeSql("INSERT INTO "+u["logger-db"]+" (log) VALUES (?)",[i])})}function n(){a.transaction(function(e){e.executeSql("SELECT log FROM "+u["logger-db"],[],function(e,o){var r,t=[],n=o.rows.length;for(r=0;n>r;r++)t.push(o.rows.item(r).log+"\r\n");var l=document.createElement("a"),i=new Blob(t,{type:"application/octet-stream"});l.href=window.URL.createObjectURL(i),l.download=u.logger_prefix+(new Date).toUTCString()+".txt",l.click()})})}function l(){a.transaction(function(e){e.executeSql("DELETE FROM "+u["logger-db"]),log.info("Cleared logs",null,!1)})}function i(e,o,r,n,l){var i,a=(new Date).toLocaleString(),g="EXCEPTION";i=l?l.stack:o+" @ line:"+r,t(g,e,i,a,l)}var a,g="0.2.0",c=document.currentScript,s={ERROR:1,WARN:2,INFO:3,DEBUG:4,TRACE:5},d=Object.create(null,{});d["logger-prefix"]="thisJs-logger",d["logger-db"]="choose_a_unique_name_for_your_website",d["logger-db-descp"]="thisJs-logger logs table",d["logger-max-records"]=300,d["logger-auto-instance"]=!0,d["logger-level"]="TRACE",d["logger-record-flag"]=!1;var u=e(d);u["logger-prefix"]+=" - ",u["logger-remove-limit"]=.4*u["logger-max-records"];var f=window.location.hash,w=Object.create(null,{});w.ns=null,w.ns_list=null;for(var h=/([0-9a-zA-Z_-]*)=([0-9a-zA-Z_-\s]*)/g,b=h.exec(f);null!=b;)w[b[1]]=2 in b?b[2]:!0,b=h.exec(f);w.ns&&(w.ns_list=w.ns.split(","));var E={ERROR:{header:"font-weight:bold;color:red;",body:"font-weight:normal;color:red;"},WARN:{header:"font-weight:bold;color:darkred;",body:"font-weight:normal;color:darkred;"},INFO:{header:"font-weight:bold;",body:"font-weight:normal;"},DEBUG:{header:"font-weight:bold;color:#01014C;",body:"font-weight:normal;color:#01014C;"},TRACE:{header:"font-weight:bold;color:#054C05;",body:"font-weight:normal;color:#054C05;"}},R=function(){};if(window.debug_settings=w,window.thisJsLogger=function(e,o){o=o?o:"",this.settings=Object.create(null,{});for(var t in u)this.settings[t]=e&&t in e?e[t]:u[t];this.error=r(this,"ERROR",o),this.warn=r(this,"ERROR",o),this.info=r(this,"INFO",o),this.debug=r(this,"DEBUG",o),this.trace=r(this,"TRACE",o),this.clear=l,this.download=n,this.trace("RUNNING thisJs-logger v"+g+"--- ON PAGE: "+window.location)},u["logger-auto-instance"]&&(window.log=new thisJsLogger),window.onerror){var v=window.onerror;window.onerror=function(){v.apply(this,arguments),i.apply(this,arguments)}}else window.onerror=i;window.setInterval(function(){var e=o();e.transaction(function(e){e.executeSql("SELECT COUNT(*) AS c FROM "+u["logger-db"],[],function(e,o){var r=o.rows.item(0).c;parseInt(r)>u["logger-max-records"]&&e.executeSql("DELETE FROM "+u["logger-db"]+" WHERE rowid IN (SELECT rowid FROM "+u["logger-db"]+" ASC LIMIT "+u["logger-remove-limit"]+")",[],function(){log.warn("Cleared "+u["logger-remove-limit"]+" records from the db")},function(e,o){console.log(o)})},function(e,o){log.warn("Could not auto-clear: "+o.message)})})},200)}();