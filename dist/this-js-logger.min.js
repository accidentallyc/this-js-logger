!function(){function o(o){var t=u[o];return function(r,n,l){if(!(w<f[o])){void 0==l&&(l=!0);var i=(new Date).toLocaleString(),a=(new Error).stack.substring(6);if(n){var c="%c"+o+" %c"+r+" -- "+i;console.log(c,t.header,t.body,n),console.log("%c"+a,t.body)}else{var g="%c"+o+" %c"+r+" -- "+i+"\n"+a;console.log(g,t.header,t.body)}l&&e(o,r,a,i,n)}}}function e(o,e,t,r,n){s.transaction(function(l){var i=o+" : "+e+" -- "+r;n&&(i+=" "+JSON.stringify(n)),i+="\r\n"+t,l.executeSql("INSERT INTO "+c+" (log) VALUES (?)",[i])})}function t(){s.transaction(function(o){o.executeSql("SELECT log FROM "+c,[],function(o,e){var t,r=[],n=e.rows.length;for(t=0;n>t;t++)r.push(e.rows.item(t).log+"\r\n");var l=document.createElement("a"),i=new Blob(r,{type:"application/octet-stream"});l.href=window.URL.createObjectURL(i),l.download=a+(new Date).toUTCString()+".txt",l.click()})})}function r(){s.transaction(function(o){o.executeSql("DELETE FROM "+c),log.info("Cleared logs",null,!1)})}function n(o,t,r,n,l){var i,a=(new Date).toLocaleString(),c="EXCEPTION";i=l?l.stack:t+" @ line:"+r,e(c,o,i,a,l)}var l="0.1.2",i=document.currentScript,a=i.getAttribute("logger-file-prefix");a||(a="thisJs-logger"),a+=" - ";var c=i.getAttribute("logger-db");c||(c="thisJs_logger");var g=i.getAttribute("logger-db-descp");g||(g="thisJs-logger logs table");var d=i.getAttribute("logger-max-records");d||(d=300),logger_remove_limit=.4*d;var s=openDatabase(c,"1.0",g,512);s.transaction(function(o){o.executeSql("CREATE TABLE IF NOT EXISTS "+c+" (log TEXT)")});var u={ERROR:{header:"font-weight:bold;color:red;",body:"font-weight:normal;color:red;"},WARN:{header:"font-weight:bold;color:darkred;",body:"font-weight:normal;color:darkred;"},INFO:{header:"font-weight:bold;",body:"font-weight:normal;"},DEBUG:{header:"font-weight:bold;color:#01014C;",body:"font-weight:normal;color:#01014C;"},TRACE:{header:"font-weight:bold;color:#054C05;",body:"font-weight:normal;color:#054C05;"}},f={ERROR:1,WARN:2,INFO:3,DEBUG:4,TRACE:5},w=i.getAttribute("logger-level");if(w=void 0==w?f.TRACE:f[w.toUpperCase()],window.log={error:o("ERROR"),warn:o("WARN"),info:o("INFO"),debug:o("DEBUG"),trace:o("TRACE"),download:t,clear:r},window.onerror){var E=window.onerror;window.onerror=function(){E.apply(this,arguments),n.apply(this,arguments)}}else window.onerror=n;s.transaction(function(o){o.executeSql("SELECT COUNT(*) AS c FROM "+c,[],function(o,e){var t=e.rows.item(0).c;parseInt(t)>d&&o.executeSql("DELETE FROM "+c+" WHERE rowid IN (SELECT rowid FROM "+c+" ASC LIMIT "+logger_remove_limit+")",[],function(){log.warn("Cleared 10 records from the db")},function(o,e){console.log(e)})},function(o,e){log.warn("Could not auto-clear: "+e.message)})}),log.trace("RUNNING thisJs-logger v"+l+"--- ON PAGE: "+window.location)}();